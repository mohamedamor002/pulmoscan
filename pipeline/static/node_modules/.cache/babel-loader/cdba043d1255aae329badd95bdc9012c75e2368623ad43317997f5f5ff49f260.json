{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useLocation}from'react-router-dom';import axios from'axios';import{DocumentTextIcon,ExclamationCircleIcon,TrashIcon,XMarkIcon,ArrowUpIcon,ArrowDownIcon,FunnelIcon,MagnifyingGlassIcon,ChevronLeftIcon,ChevronRightIcon}from'@heroicons/react/24/outline';import{useAuth}from'../contexts/AuthContext';import{useTheme}from'../contexts/ThemeContext';import{ROLES}from'../contexts/AuthContext';import InteractiveViewer from'../components/InteractiveViewer';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ResultsPage=()=>{var _location$state;const location=useLocation();const[results,setResults]=useState([]);const[filteredResults,setFilteredResults]=useState([]);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const[showDeleteModal,setShowDeleteModal]=useState(false);const[scanToDelete,setScanToDelete]=useState(null);const[deleteSuccess,setDeleteSuccess]=useState(((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.deleteSuccess)||'');const{user}=useAuth();const{darkMode}=useTheme();// Filter and sort states\nconst[searchQuery,setSearchQuery]=useState('');const[sortField,setSortField]=useState('timestamp');const[sortDirection,setSortDirection]=useState('desc');const[showFilters,setShowFilters]=useState(false);const[dateFilter,setDateFilter]=useState('all');const[noduleFilter,setNoduleFilter]=useState('all');// Pagination state\nconst[currentPage,setCurrentPage]=useState(1);const[itemsPerPage]=useState(6);const[totalPages,setTotalPages]=useState(1);// Animation state for newly loaded items\nconst[animatedItems,setAnimatedItems]=useState([]);// Clear the location state after displaying a success message\nuseEffect(()=>{var _location$state2;if((_location$state2=location.state)!==null&&_location$state2!==void 0&&_location$state2.deleteSuccess){// Clear the success message after 3 seconds\nconst timer=setTimeout(()=>{setDeleteSuccess('');// Clear the state from the location to avoid showing the message on refresh\nwindow.history.replaceState({},document.title);},3000);return()=>clearTimeout(timer);}},[location.state]);// Animate items as they appear\nuseEffect(()=>{if(filteredResults.length>0&&animatedItems.length===0){// Stagger the animation of items for visual effect\nlet timeoutId;filteredResults.forEach((result,index)=>{timeoutId=setTimeout(()=>{setAnimatedItems(prev=>[...prev,result.case_name]);},index*50);// 50ms stagger between items\n});return()=>clearTimeout(timeoutId);}},[filteredResults]);const fetchResults=async()=>{try{setIsLoading(true);// Use the user-specific endpoint for doctors and the global endpoint for admins/superadmins\nconst endpoint=user.role===ROLES.ADMIN||user.role===ROLES.SUPERADMIN?'/api/results':'/api/results/user';const response=await axios.get(endpoint);// Sort by timestamp, newest first\nconst sortedResults=response.data.sort((a,b)=>new Date(b.timestamp)-new Date(a.timestamp));// Debug log to see what data we're getting\nconsole.log('Results data:',sortedResults);setResults(sortedResults);setFilteredResults(sortedResults);setIsLoading(false);}catch(error){console.error('Error fetching results:',error);setError('Failed to load results. Please try again later.');setIsLoading(false);}};useEffect(()=>{fetchResults();},[user.role]);// Apply filters and sorting when relevant states change\nuseEffect(()=>{// Reset animations when filters change\nsetAnimatedItems([]);let filtered=[...results];// Apply search filter\nif(searchQuery){const query=searchQuery.toLowerCase();filtered=filtered.filter(scan=>{var _scan$patient_info,_scan$patient_info2;return scan.case_name&&scan.case_name.toLowerCase().includes(query)||scan.details&&scan.details.toLowerCase().includes(query)||((_scan$patient_info=scan.patient_info)===null||_scan$patient_info===void 0?void 0:_scan$patient_info.name)&&scan.patient_info.name.toLowerCase().includes(query)||((_scan$patient_info2=scan.patient_info)===null||_scan$patient_info2===void 0?void 0:_scan$patient_info2.description)&&scan.patient_info.description.toLowerCase().includes(query);});}// Apply date filter\nif(dateFilter!=='all'){const now=new Date();const oneDayAgo=new Date(now.setDate(now.getDate()-1));const oneWeekAgo=new Date(now.setDate(now.getDate()-7));const oneMonthAgo=new Date(now.setMonth(now.getMonth()-1));filtered=filtered.filter(scan=>{const scanDate=new Date(scan.timestamp);switch(dateFilter){case'today':return scanDate>=oneDayAgo;case'week':return scanDate>=oneWeekAgo;case'month':return scanDate>=oneMonthAgo;default:return true;}});}// Apply nodule filter\nif(noduleFilter!=='all'){filtered=filtered.filter(scan=>{const hasNodules=scan.details&&!scan.details.includes('No nodules detected')&&!scan.details.includes('No detailed information available');return noduleFilter==='with_nodules'?hasNodules:!hasNodules;});}// Apply sorting\nfiltered.sort((a,b)=>{let aValue,bValue;switch(sortField){case'timestamp':aValue=new Date(a.timestamp||0);bValue=new Date(b.timestamp||0);break;case'name':aValue=a.case_name||'';bValue=b.case_name||'';break;case'patient':aValue=extractPatientName(a).toLowerCase();bValue=extractPatientName(b).toLowerCase();break;default:aValue=new Date(a.timestamp||0);bValue=new Date(b.timestamp||0);}// For string comparisons\nif(typeof aValue==='string'){return sortDirection==='asc'?aValue.localeCompare(bValue):bValue.localeCompare(aValue);}// For date comparisons and other types\nreturn sortDirection==='asc'?aValue-bValue:bValue-aValue;});setFilteredResults(filtered);setTotalPages(Math.ceil(filtered.length/itemsPerPage));setCurrentPage(1);// Reset to first page when filters change\n},[results,searchQuery,sortField,sortDirection,dateFilter,noduleFilter]);// Get current page items\nconst getCurrentPageItems=()=>{const startIndex=(currentPage-1)*itemsPerPage;const endIndex=startIndex+itemsPerPage;return filteredResults.slice(startIndex,endIndex);};// Handle page change\nconst handlePageChange=page=>{setCurrentPage(page);window.scrollTo({top:0,behavior:'smooth'});};// Toggle sort direction or change sort field\nconst handleSort=field=>{if(sortField===field){// Toggle direction if same field\nsetSortDirection(sortDirection==='asc'?'desc':'asc');}else{// New field, default to descending for dates, ascending for text\nsetSortField(field);setSortDirection(field==='timestamp'?'desc':'asc');}};// Check if the current user can delete a specific scan\nconst canDeleteScan=scan=>{// Extract owner username from case name (if the format is username_filename)\nconst scanOwner=scan.case_name.split('_')[0];// Superadmin can delete any scan\nif(user.role===ROLES.SUPERADMIN){return true;}// Owners can always delete their own scans\nif(scanOwner===user.username){return true;}// Admins can delete scans from doctors they've created\nif(user.role===ROLES.ADMIN){// In a real implementation, this would check if the admin created the doctor\n// For now, we'll assume admins can delete any doctor's scans\nreturn true;}// By default, users can't delete other users' scans\nreturn false;};// Opens the delete confirmation modal\nconst openDeleteModal=(scan,e)=>{e.preventDefault();// Prevent navigation to scan details\ne.stopPropagation();// Prevent event bubbling\nsetScanToDelete(scan);setShowDeleteModal(true);};// Handles scan deletion\nconst handleDeleteScan=async()=>{try{await axios.delete(`/api/results/${scanToDelete.case_name}`);setResults(results.filter(r=>r.case_name!==scanToDelete.case_name));setDeleteSuccess(`Scan ${scanToDelete.case_name} has been deleted successfully.`);setScanToDelete(null);setShowDeleteModal(false);// Clear success message after 3 seconds\nsetTimeout(()=>{setDeleteSuccess('');},3000);}catch(error){console.error('Error deleting scan:',error);setError('Failed to delete scan. Please try again later.');setShowDeleteModal(false);}};// Helper function to extract a title from scan details\nconst extractTitle=scan=>{// Check if there's patient information available\nif(scan.patient_info&&scan.patient_info.description){// Limit the length of the description to avoid too long titles\nconst description=scan.patient_info.description;return description.length>100?description.substring(0,100)+'...':description;}// Fall back to extracting from details if no patient info description\nif(!scan.details)return\"No details available\";// Look for patient information in the details\nconst lines=scan.details.split('\\n');// Look for Clinical Notes section\nlet foundClinicNotes=false;for(let i=0;i<lines.length;i++){if(lines[i].includes('Clinical Notes:')){foundClinicNotes=true;// Return the clinical notes (on the next line or after the colon)\nif(lines[i].split('Clinical Notes:').length>1){const notes=lines[i].split('Clinical Notes:')[1].trim();// Limit length of long notes\nreturn notes.length>100?notes.substring(0,100)+'...':notes||\"No clinical notes available\";}else if(i+1<lines.length){const notes=lines[i+1].trim();return notes.length>100?notes.substring(0,100)+'...':notes||\"No clinical notes available\";}}}// If no clinical notes found, extract the first meaningful line\nconst titleLine=lines.find(line=>!line.startsWith('Nodule')&&!line.includes('Coordinates')&&!line.includes('Radius')&&!line.includes('Confidence')&&!line.includes('segmentation performed'));if(titleLine){return titleLine.length>100?titleLine.substring(0,100)+'...':titleLine;}return scan.details.length>100?scan.details.substring(0,100)+'...':scan.details;};// Helper function to extract patient name\nconst extractPatientName=scan=>{// Default username to use if no patient name is found\nconst defaultName=scan.case_name.split('_')[0];// First check patient_info object if available\nif(scan.patient_info&&scan.patient_info.name){return scan.patient_info.name;}// Fall back to extracting from details\nif(!scan.details)return defaultName;const lines=scan.details.split('\\n');// Look for Name: or Patient Name: in the details\nfor(let i=0;i<lines.length;i++){if(lines[i].includes('Name:')||lines[i].includes('Patient Name:')){// Extract name from current line if it's after the colon\nif(lines[i].split(':').length>1){const name=lines[i].split(':')[1].trim();return name||defaultName;}// Otherwise check the next line which might contain the name\nelse if(i+1<lines.length){return lines[i+1].trim()||defaultName;}}}// Default to the scan owner username if no patient name found\nreturn defaultName;};// Helper function to determine if a scan has nodules\nconst scanHasNodules=scan=>{return scan.details&&!scan.details.includes('No nodules detected')&&!scan.details.includes('No detailed information available');};// Helper function to format date\nconst formatDate=dateString=>{if(!dateString)return'Unknown date';const date=new Date(dateString);return date.toLocaleString('en-US',{month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit'});};if(isLoading){return/*#__PURE__*/_jsxs(\"div\",{className:`text-center py-12 ${darkMode?'text-white':''}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent\"}),/*#__PURE__*/_jsx(\"p\",{className:`mt-4 ${darkMode?'text-gray-300':'text-gray-600'}`,children:\"Loading scan results...\"})]});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:`${darkMode?'bg-red-900':'bg-red-50'} p-4 rounded-md`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(ExclamationCircleIcon,{className:`h-5 w-5 ${darkMode?'text-red-300':'text-red-400'}`,\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-3\",children:/*#__PURE__*/_jsx(\"h3\",{className:`text-sm font-medium ${darkMode?'text-red-300':'text-red-800'}`,children:error})})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:darkMode?'text-white':'',children:[/*#__PURE__*/_jsxs(\"div\",{className:\"md:flex md:items-center md:justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:`text-2xl font-semibold ${darkMode?'text-white':'text-gray-900'}`,children:\"Scan Results\"}),/*#__PURE__*/_jsxs(\"p\",{className:`mt-1 text-sm ${darkMode?'text-gray-300':'text-gray-500'}`,children:[filteredResults.length,\" \",filteredResults.length===1?'result':'results',\" found\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 md:mt-0 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2\",children:/*#__PURE__*/_jsx(Link,{to:\"/upload\",className:\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700\",children:\"Upload New Scan\"})})]}),deleteSuccess&&/*#__PURE__*/_jsx(\"div\",{className:`mb-6 ${darkMode?'bg-green-900/50 border-green-700':'bg-green-50 border-green-200'} border rounded-md p-4`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"svg\",{className:`h-5 w-5 ${darkMode?'text-green-300':'text-green-400'}`,xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-3\",children:/*#__PURE__*/_jsx(\"p\",{className:`text-sm font-medium ${darkMode?'text-green-300':'text-green-800'}`,children:deleteSuccess})})]})}),/*#__PURE__*/_jsx(\"div\",{className:`${darkMode?'bg-gray-800':'bg-white'} rounded-lg shadow-sm mb-6`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\",children:/*#__PURE__*/_jsx(MagnifyingGlassIcon,{className:`h-5 w-5 ${darkMode?'text-gray-400':'text-gray-500'}`})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search scans...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:`block w-full pl-10 pr-4 py-2 border ${darkMode?'bg-gray-700 border-gray-600 placeholder-gray-400 text-white':'border-gray-300 placeholder-gray-500 text-gray-900'} rounded-md`})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`inline-flex shadow-sm rounded-md ${darkMode?'bg-gray-700':'bg-gray-100'}`,children:[/*#__PURE__*/_jsxs(\"button\",{className:`px-3 py-2 rounded-l-md text-sm font-medium ${sortField==='timestamp'?darkMode?'bg-gray-600 text-indigo-300':'bg-indigo-100 text-indigo-700':''}`,onClick:()=>handleSort('timestamp'),children:[\"Date\",sortField==='timestamp'&&(sortDirection==='asc'?/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"ml-1 h-4 w-4 inline\"}):/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"ml-1 h-4 w-4 inline\"}))]}),/*#__PURE__*/_jsxs(\"button\",{className:`px-3 py-2 text-sm font-medium ${sortField==='name'?darkMode?'bg-gray-600 text-indigo-300':'bg-indigo-100 text-indigo-700':''}`,onClick:()=>handleSort('name'),children:[\"Case ID\",sortField==='name'&&(sortDirection==='asc'?/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"ml-1 h-4 w-4 inline\"}):/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"ml-1 h-4 w-4 inline\"}))]}),/*#__PURE__*/_jsxs(\"button\",{className:`px-3 py-2 rounded-r-md text-sm font-medium ${sortField==='patient'?darkMode?'bg-gray-600 text-indigo-300':'bg-indigo-100 text-indigo-700':''}`,onClick:()=>handleSort('patient'),children:[\"Patient\",sortField==='patient'&&(sortDirection==='asc'?/*#__PURE__*/_jsx(ArrowUpIcon,{className:\"ml-1 h-4 w-4 inline\"}):/*#__PURE__*/_jsx(ArrowDownIcon,{className:\"ml-1 h-4 w-4 inline\"}))]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowFilters(!showFilters),className:`inline-flex items-center px-4 py-2 border rounded-md text-sm font-medium ${showFilters?darkMode?'bg-indigo-700 text-white border-indigo-500':'bg-indigo-100 text-indigo-700 border-indigo-300':darkMode?'border-gray-600 text-gray-300 hover:bg-gray-700':'border-gray-300 text-gray-700 hover:bg-gray-50'}`,children:[/*#__PURE__*/_jsx(FunnelIcon,{className:\"mr-2 h-4 w-4\"}),\"Filters\"]})]})]}),showFilters&&/*#__PURE__*/_jsx(\"div\",{className:`mt-4 pt-4 border-t ${darkMode?'border-gray-700':'border-gray-200'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:`block text-sm font-medium mb-1 ${darkMode?'text-gray-300':'text-gray-700'}`,children:\"Time Period\"}),/*#__PURE__*/_jsxs(\"select\",{value:dateFilter,onChange:e=>setDateFilter(e.target.value),className:`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${darkMode?'bg-gray-700 border-gray-600 text-white':'bg-white'}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All time\"}),/*#__PURE__*/_jsx(\"option\",{value:\"today\",children:\"Last 24 hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"week\",children:\"Last 7 days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"month\",children:\"Last 30 days\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:`block text-sm font-medium mb-1 ${darkMode?'text-gray-300':'text-gray-700'}`,children:\"Nodules\"}),/*#__PURE__*/_jsxs(\"select\",{value:noduleFilter,onChange:e=>setNoduleFilter(e.target.value),className:`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${darkMode?'bg-gray-700 border-gray-600 text-white':'bg-white'}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All scans\"}),/*#__PURE__*/_jsx(\"option\",{value:\"with_nodules\",children:\"With nodules\"}),/*#__PURE__*/_jsx(\"option\",{value:\"without_nodules\",children:\"Without nodules\"})]})]})]})})]})}),filteredResults.length===0?/*#__PURE__*/_jsxs(\"div\",{className:`text-center py-12 ${darkMode?'text-gray-400':'text-gray-500'}`,children:[/*#__PURE__*/_jsx(DocumentTextIcon,{className:\"mx-auto h-12 w-12 mb-4 opacity-50\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium mb-1\",children:\"No results found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Try adjusting your search or filters\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 gap-8\",children:getCurrentPageItems().map(scan=>{const hasNodules=scanHasNodules(scan);const isAnimated=animatedItems.includes(scan.case_name);const patientName=extractPatientName(scan);const clinicalNotes=extractTitle(scan);const creationDate=formatDate(scan.timestamp);return/*#__PURE__*/_jsx(Link,{to:`/results/${scan.case_name}`,className:`block ${darkMode?'bg-gray-800':'bg-white'} rounded-lg shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl transform hover:-translate-y-1 ${isAnimated?'opacity-100 translate-y-0':'opacity-0 translate-y-4'}`,children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative md:w-1/3 bg-gray-100 overflow-hidden\",style:{height:'260px'},children:/*#__PURE__*/_jsx(InteractiveViewer,{caseId:scan.case_name,selectedNoduleId:null,resultsPageView:true})}),/*#__PURE__*/_jsxs(\"div\",{className:`p-6 md:w-2/3 ${hasNodules?darkMode?'bg-green-900/20':'bg-green-50':''}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:`text-xl font-semibold ${darkMode?'text-white':'text-gray-900'}`,children:patientName}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[hasNodules&&/*#__PURE__*/_jsx(\"span\",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${darkMode?'bg-green-800 text-green-100':'bg-green-100 text-green-800'}`,children:\"Nodules Detected\"}),canDeleteScan(scan)&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>openDeleteModal(scan,e),className:`p-1 rounded-full ${darkMode?'hover:bg-gray-700 text-gray-400 hover:text-gray-200':'hover:bg-gray-100 text-gray-500 hover:text-gray-700'}`,children:/*#__PURE__*/_jsx(TrashIcon,{className:\"h-4 w-4\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:`text-sm mb-3 ${darkMode?'text-gray-400':'text-gray-500'}`,children:creationDate}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:`text-sm font-medium mb-1 ${darkMode?'text-gray-200':'text-gray-700'}`,children:\"Clinical Notes:\"}),/*#__PURE__*/_jsx(\"p\",{className:`text-sm line-clamp-4 ${darkMode?'text-gray-300':'text-gray-600'}`,children:clinicalNotes||\"No clinical notes available\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end items-center mt-4\",children:/*#__PURE__*/_jsx(\"span\",{className:`font-medium ${darkMode?'text-indigo-400':'text-indigo-600'}`,children:\"View details \\u2192\"})})]})]})},scan.case_name);})}),totalPages>1&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 flex justify-center\",children:/*#__PURE__*/_jsxs(\"nav\",{className:\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\",\"aria-label\":\"Pagination\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handlePageChange(currentPage-1),disabled:currentPage===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border ${darkMode?'border-gray-600 bg-gray-700 text-gray-300':'border-gray-300 bg-white text-gray-500'} text-sm font-medium ${currentPage===1?'opacity-50 cursor-not-allowed':darkMode?'hover:bg-gray-600':'hover:bg-gray-50'}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Previous\"}),/*#__PURE__*/_jsx(ChevronLeftIcon,{className:\"h-5 w-5\",\"aria-hidden\":\"true\"})]}),[...Array(totalPages)].map((_,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(index+1),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${currentPage===index+1?darkMode?'z-10 bg-indigo-600 border-indigo-500 text-white':'z-10 bg-indigo-50 border-indigo-500 text-indigo-600':darkMode?'border-gray-600 bg-gray-700 text-gray-300 hover:bg-gray-600':'border-gray-300 bg-white text-gray-500 hover:bg-gray-50'}`,children:index+1},index+1)),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handlePageChange(currentPage+1),disabled:currentPage===totalPages,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border ${darkMode?'border-gray-600 bg-gray-700 text-gray-300':'border-gray-300 bg-white text-gray-500'} text-sm font-medium ${currentPage===totalPages?'opacity-50 cursor-not-allowed':darkMode?'hover:bg-gray-600':'hover:bg-gray-50'}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Next\"}),/*#__PURE__*/_jsx(ChevronRightIcon,{className:\"h-5 w-5\",\"aria-hidden\":\"true\"})]})]})})]}),showDeleteModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-10 overflow-y-auto\",\"aria-labelledby\":\"modal-title\",role:\"dialog\",\"aria-modal\":\"true\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\",\"aria-hidden\":\"true\",onClick:()=>setShowDeleteModal(false)}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline-block sm:align-middle sm:h-screen\",\"aria-hidden\":\"true\",children:\"\\u200B\"}),/*#__PURE__*/_jsxs(\"div\",{className:`inline-block align-bottom ${darkMode?'bg-gray-800':'bg-white'} rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pt-5 pb-4 sm:p-6 sm:pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sm:flex sm:items-start\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10\",children:/*#__PURE__*/_jsx(ExclamationCircleIcon,{className:\"h-6 w-6 text-red-600\",\"aria-hidden\":\"true\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left\",children:[/*#__PURE__*/_jsx(\"h3\",{className:`text-lg leading-6 font-medium ${darkMode?'text-white':'text-gray-900'}`,id:\"modal-title\",children:\"Delete Scan\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:`text-sm ${darkMode?'text-gray-300':'text-gray-500'}`,children:\"Are you sure you want to delete this scan? This action cannot be undone.\"}),/*#__PURE__*/_jsx(\"p\",{className:`mt-2 text-sm font-medium ${darkMode?'text-gray-200':'text-gray-700'}`,children:scanToDelete===null||scanToDelete===void 0?void 0:scanToDelete.case_name})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:`px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse ${darkMode?'bg-gray-700':'bg-gray-50'}`,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm\",onClick:handleDeleteScan,children:\"Delete\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:`mt-3 w-full inline-flex justify-center rounded-md border ${darkMode?'border-gray-500 bg-gray-700 text-white hover:bg-gray-600':'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'} shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm`,onClick:()=>setShowDeleteModal(false),children:\"Cancel\"})]})]})]})})]});};export default ResultsPage;","map":{"version":3,"names":["React","useState","useEffect","Link","useLocation","axios","DocumentTextIcon","ExclamationCircleIcon","TrashIcon","XMarkIcon","ArrowUpIcon","ArrowDownIcon","FunnelIcon","MagnifyingGlassIcon","ChevronLeftIcon","ChevronRightIcon","useAuth","useTheme","ROLES","InteractiveViewer","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ResultsPage","_location$state","location","results","setResults","filteredResults","setFilteredResults","isLoading","setIsLoading","error","setError","showDeleteModal","setShowDeleteModal","scanToDelete","setScanToDelete","deleteSuccess","setDeleteSuccess","state","user","darkMode","searchQuery","setSearchQuery","sortField","setSortField","sortDirection","setSortDirection","showFilters","setShowFilters","dateFilter","setDateFilter","noduleFilter","setNoduleFilter","currentPage","setCurrentPage","itemsPerPage","totalPages","setTotalPages","animatedItems","setAnimatedItems","_location$state2","timer","setTimeout","window","history","replaceState","document","title","clearTimeout","length","timeoutId","forEach","result","index","prev","case_name","fetchResults","endpoint","role","ADMIN","SUPERADMIN","response","get","sortedResults","data","sort","a","b","Date","timestamp","console","log","filtered","query","toLowerCase","filter","scan","_scan$patient_info","_scan$patient_info2","includes","details","patient_info","name","description","now","oneDayAgo","setDate","getDate","oneWeekAgo","oneMonthAgo","setMonth","getMonth","scanDate","hasNodules","aValue","bValue","extractPatientName","localeCompare","Math","ceil","getCurrentPageItems","startIndex","endIndex","slice","handlePageChange","page","scrollTo","top","behavior","handleSort","field","canDeleteScan","scanOwner","split","username","openDeleteModal","e","preventDefault","stopPropagation","handleDeleteScan","delete","r","extractTitle","substring","lines","foundClinicNotes","i","notes","trim","titleLine","find","line","startsWith","defaultName","scanHasNodules","formatDate","dateString","date","toLocaleString","month","day","year","hour","minute","className","children","to","xmlns","viewBox","fill","fillRule","d","clipRule","type","placeholder","value","onChange","target","onClick","map","isAnimated","patientName","clinicalNotes","creationDate","style","height","caseId","selectedNoduleId","resultsPageView","disabled","Array","_","id"],"sources":["C:/Users/kouss/Desktop/Cursor/Segmentation/pipeline/webapp/static/src/pages/ResultsPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport { DocumentTextIcon, ExclamationCircleIcon, TrashIcon, XMarkIcon, ArrowUpIcon, ArrowDownIcon, FunnelIcon, MagnifyingGlassIcon, ChevronLeftIcon, ChevronRightIcon } from '@heroicons/react/24/outline';\nimport { useAuth } from '../contexts/AuthContext';\nimport { useTheme } from '../contexts/ThemeContext';\nimport { ROLES } from '../contexts/AuthContext';\nimport InteractiveViewer from '../components/InteractiveViewer';\n\nconst ResultsPage = () => {\n  const location = useLocation();\n  const [results, setResults] = useState([]);\n  const [filteredResults, setFilteredResults] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n  const [scanToDelete, setScanToDelete] = useState(null);\n  const [deleteSuccess, setDeleteSuccess] = useState(location.state?.deleteSuccess || '');\n  const { user } = useAuth();\n  const { darkMode } = useTheme();\n  \n  // Filter and sort states\n  const [searchQuery, setSearchQuery] = useState('');\n  const [sortField, setSortField] = useState('timestamp');\n  const [sortDirection, setSortDirection] = useState('desc');\n  const [showFilters, setShowFilters] = useState(false);\n  const [dateFilter, setDateFilter] = useState('all');\n  const [noduleFilter, setNoduleFilter] = useState('all');\n\n  // Pagination state\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage] = useState(6);\n  const [totalPages, setTotalPages] = useState(1);\n\n  // Animation state for newly loaded items\n  const [animatedItems, setAnimatedItems] = useState([]);\n\n  // Clear the location state after displaying a success message\n  useEffect(() => {\n    if (location.state?.deleteSuccess) {\n      // Clear the success message after 3 seconds\n      const timer = setTimeout(() => {\n        setDeleteSuccess('');\n        // Clear the state from the location to avoid showing the message on refresh\n        window.history.replaceState({}, document.title);\n      }, 3000);\n      \n      return () => clearTimeout(timer);\n    }\n  }, [location.state]);\n\n  // Animate items as they appear\n  useEffect(() => {\n    if (filteredResults.length > 0 && animatedItems.length === 0) {\n      // Stagger the animation of items for visual effect\n      let timeoutId;\n      filteredResults.forEach((result, index) => {\n        timeoutId = setTimeout(() => {\n          setAnimatedItems(prev => [...prev, result.case_name]);\n        }, index * 50); // 50ms stagger between items\n      });\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [filteredResults]);\n\n    const fetchResults = async () => {\n      try {\n        setIsLoading(true);\n      // Use the user-specific endpoint for doctors and the global endpoint for admins/superadmins\n      const endpoint = (user.role === ROLES.ADMIN || user.role === ROLES.SUPERADMIN) \n        ? '/api/results' \n        : '/api/results/user';\n      const response = await axios.get(endpoint);\n      \n        // Sort by timestamp, newest first\n        const sortedResults = response.data.sort((a, b) => \n          new Date(b.timestamp) - new Date(a.timestamp)\n        );\n      \n      // Debug log to see what data we're getting\n      console.log('Results data:', sortedResults);\n      \n        setResults(sortedResults);\n      setFilteredResults(sortedResults);\n        setIsLoading(false);\n      } catch (error) {\n        console.error('Error fetching results:', error);\n        setError('Failed to load results. Please try again later.');\n        setIsLoading(false);\n      }\n    };\n\n  useEffect(() => {\n    fetchResults();\n  }, [user.role]);\n\n  // Apply filters and sorting when relevant states change\n  useEffect(() => {\n    // Reset animations when filters change\n    setAnimatedItems([]);\n    \n    let filtered = [...results];\n    \n    // Apply search filter\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      filtered = filtered.filter(scan => \n        (scan.case_name && scan.case_name.toLowerCase().includes(query)) ||\n        (scan.details && scan.details.toLowerCase().includes(query)) ||\n        (scan.patient_info?.name && scan.patient_info.name.toLowerCase().includes(query)) ||\n        (scan.patient_info?.description && scan.patient_info.description.toLowerCase().includes(query))\n      );\n    }\n    \n    // Apply date filter\n    if (dateFilter !== 'all') {\n      const now = new Date();\n      const oneDayAgo = new Date(now.setDate(now.getDate() - 1));\n      const oneWeekAgo = new Date(now.setDate(now.getDate() - 7));\n      const oneMonthAgo = new Date(now.setMonth(now.getMonth() - 1));\n      \n      filtered = filtered.filter(scan => {\n        const scanDate = new Date(scan.timestamp);\n        \n        switch (dateFilter) {\n          case 'today':\n            return scanDate >= oneDayAgo;\n          case 'week':\n            return scanDate >= oneWeekAgo;\n          case 'month':\n            return scanDate >= oneMonthAgo;\n          default:\n            return true;\n        }\n      });\n    }\n    \n    // Apply nodule filter\n    if (noduleFilter !== 'all') {\n      filtered = filtered.filter(scan => {\n        const hasNodules = scan.details && \n          !scan.details.includes('No nodules detected') && \n          !scan.details.includes('No detailed information available');\n        \n        return noduleFilter === 'with_nodules' ? hasNodules : !hasNodules;\n      });\n    }\n    \n    // Apply sorting\n    filtered.sort((a, b) => {\n      let aValue, bValue;\n      \n      switch (sortField) {\n        case 'timestamp':\n          aValue = new Date(a.timestamp || 0);\n          bValue = new Date(b.timestamp || 0);\n          break;\n        case 'name':\n          aValue = a.case_name || '';\n          bValue = b.case_name || '';\n          break;\n        case 'patient':\n          aValue = extractPatientName(a).toLowerCase();\n          bValue = extractPatientName(b).toLowerCase();\n          break;\n        default:\n          aValue = new Date(a.timestamp || 0);\n          bValue = new Date(b.timestamp || 0);\n      }\n      \n      // For string comparisons\n      if (typeof aValue === 'string') {\n        return sortDirection === 'asc' \n          ? aValue.localeCompare(bValue)\n          : bValue.localeCompare(aValue);\n      }\n      \n      // For date comparisons and other types\n      return sortDirection === 'asc' ? aValue - bValue : bValue - aValue;\n    });\n    \n    setFilteredResults(filtered);\n    setTotalPages(Math.ceil(filtered.length / itemsPerPage));\n    setCurrentPage(1); // Reset to first page when filters change\n  }, [results, searchQuery, sortField, sortDirection, dateFilter, noduleFilter]);\n\n  // Get current page items\n  const getCurrentPageItems = () => {\n    const startIndex = (currentPage - 1) * itemsPerPage;\n    const endIndex = startIndex + itemsPerPage;\n    return filteredResults.slice(startIndex, endIndex);\n  };\n\n  // Handle page change\n  const handlePageChange = (page) => {\n    setCurrentPage(page);\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n  };\n\n  // Toggle sort direction or change sort field\n  const handleSort = (field) => {\n    if (sortField === field) {\n      // Toggle direction if same field\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      // New field, default to descending for dates, ascending for text\n      setSortField(field);\n      setSortDirection(field === 'timestamp' ? 'desc' : 'asc');\n    }\n  };\n\n  // Check if the current user can delete a specific scan\n  const canDeleteScan = (scan) => {\n    // Extract owner username from case name (if the format is username_filename)\n    const scanOwner = scan.case_name.split('_')[0];\n    \n    // Superadmin can delete any scan\n    if (user.role === ROLES.SUPERADMIN) {\n      return true;\n    }\n    \n    // Owners can always delete their own scans\n    if (scanOwner === user.username) {\n      return true;\n    }\n    \n    // Admins can delete scans from doctors they've created\n    if (user.role === ROLES.ADMIN) {\n      // In a real implementation, this would check if the admin created the doctor\n      // For now, we'll assume admins can delete any doctor's scans\n      return true;\n    }\n    \n    // By default, users can't delete other users' scans\n    return false;\n  };\n\n  // Opens the delete confirmation modal\n  const openDeleteModal = (scan, e) => {\n    e.preventDefault(); // Prevent navigation to scan details\n    e.stopPropagation(); // Prevent event bubbling\n    setScanToDelete(scan);\n    setShowDeleteModal(true);\n  };\n\n  // Handles scan deletion\n  const handleDeleteScan = async () => {\n    try {\n      await axios.delete(`/api/results/${scanToDelete.case_name}`);\n      setResults(results.filter(r => r.case_name !== scanToDelete.case_name));\n      setDeleteSuccess(`Scan ${scanToDelete.case_name} has been deleted successfully.`);\n      setScanToDelete(null);\n      setShowDeleteModal(false);\n      \n      // Clear success message after 3 seconds\n      setTimeout(() => {\n        setDeleteSuccess('');\n      }, 3000);\n    } catch (error) {\n      console.error('Error deleting scan:', error);\n      setError('Failed to delete scan. Please try again later.');\n      setShowDeleteModal(false);\n    }\n  };\n\n  // Helper function to extract a title from scan details\n  const extractTitle = (scan) => {\n    // Check if there's patient information available\n    if (scan.patient_info && scan.patient_info.description) {\n      // Limit the length of the description to avoid too long titles\n      const description = scan.patient_info.description;\n      return description.length > 100 ? description.substring(0, 100) + '...' : description;\n    }\n    \n    // Fall back to extracting from details if no patient info description\n    if (!scan.details) return \"No details available\";\n    \n    // Look for patient information in the details\n    const lines = scan.details.split('\\n');\n    \n    // Look for Clinical Notes section\n    let foundClinicNotes = false;\n    for (let i = 0; i < lines.length; i++) {\n      if (lines[i].includes('Clinical Notes:')) {\n        foundClinicNotes = true;\n        // Return the clinical notes (on the next line or after the colon)\n        if (lines[i].split('Clinical Notes:').length > 1) {\n          const notes = lines[i].split('Clinical Notes:')[1].trim();\n          // Limit length of long notes\n          return notes.length > 100 ? notes.substring(0, 100) + '...' : notes || \"No clinical notes available\";\n        } else if (i + 1 < lines.length) {\n          const notes = lines[i + 1].trim();\n          return notes.length > 100 ? notes.substring(0, 100) + '...' : notes || \"No clinical notes available\";\n        }\n      }\n    }\n    \n    // If no clinical notes found, extract the first meaningful line\n    const titleLine = lines.find(line => \n      !line.startsWith('Nodule') && \n      !line.includes('Coordinates') && \n      !line.includes('Radius') && \n      !line.includes('Confidence') &&\n      !line.includes('segmentation performed')\n    );\n    \n    if (titleLine) {\n      return titleLine.length > 100 ? titleLine.substring(0, 100) + '...' : titleLine;\n    }\n    \n    return scan.details.length > 100 ? scan.details.substring(0, 100) + '...' : scan.details;\n  };\n\n  // Helper function to extract patient name\n  const extractPatientName = (scan) => {\n    // Default username to use if no patient name is found\n    const defaultName = scan.case_name.split('_')[0];\n    \n    // First check patient_info object if available\n    if (scan.patient_info && scan.patient_info.name) {\n      return scan.patient_info.name;\n    }\n    \n    // Fall back to extracting from details\n    if (!scan.details) return defaultName;\n    \n    const lines = scan.details.split('\\n');\n    \n    // Look for Name: or Patient Name: in the details\n    for (let i = 0; i < lines.length; i++) {\n      if (lines[i].includes('Name:') || lines[i].includes('Patient Name:')) {\n        // Extract name from current line if it's after the colon\n        if (lines[i].split(':').length > 1) {\n          const name = lines[i].split(':')[1].trim();\n          return name || defaultName;\n        } \n        // Otherwise check the next line which might contain the name\n        else if (i + 1 < lines.length) {\n          return lines[i + 1].trim() || defaultName;\n        }\n      }\n    }\n    \n    // Default to the scan owner username if no patient name found\n    return defaultName;\n  };\n\n  // Helper function to determine if a scan has nodules\n  const scanHasNodules = (scan) => {\n    return scan.details && \n      !scan.details.includes('No nodules detected') && \n      !scan.details.includes('No detailed information available');\n  };\n\n  // Helper function to format date\n  const formatDate = (dateString) => {\n    if (!dateString) return 'Unknown date';\n    const date = new Date(dateString);\n    return date.toLocaleString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (isLoading) {\n    return (\n      <div className={`text-center py-12 ${darkMode ? 'text-white' : ''}`}>\n        <div className=\"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-indigo-600 border-r-transparent\"></div>\n        <p className={`mt-4 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Loading scan results...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={`${darkMode ? 'bg-red-900' : 'bg-red-50'} p-4 rounded-md`}>\n        <div className=\"flex\">\n          <ExclamationCircleIcon className={`h-5 w-5 ${darkMode ? 'text-red-300' : 'text-red-400'}`} aria-hidden=\"true\" />\n          <div className=\"ml-3\">\n            <h3 className={`text-sm font-medium ${darkMode ? 'text-red-300' : 'text-red-800'}`}>{error}</h3>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n    return (\n    <div className={darkMode ? 'text-white' : ''}>\n      <div className=\"md:flex md:items-center md:justify-between mb-6\">\n        <div>\n          <h1 className={`text-2xl font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>\n            Scan Results\n          </h1>\n          <p className={`mt-1 text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>\n            {filteredResults.length} {filteredResults.length === 1 ? 'result' : 'results'} found\n          </p>\n        </div>\n        <div className=\"mt-4 md:mt-0 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2\">\n          <Link to=\"/upload\" className=\"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700\">\n            Upload New Scan\n          </Link>\n        </div>\n        </div>\n        \n      {/* Success message */}\n      {deleteSuccess && (\n        <div className={`mb-6 ${darkMode ? 'bg-green-900/50 border-green-700' : 'bg-green-50 border-green-200'} border rounded-md p-4`}>\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className={`h-5 w-5 ${darkMode ? 'text-green-300' : 'text-green-400'}`} xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.707a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n              </svg>\n            </div>\n            <div className=\"ml-3\">\n              <p className={`text-sm font-medium ${darkMode ? 'text-green-300' : 'text-green-800'}`}>{deleteSuccess}</p>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Search and filters */}\n      <div className={`${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-sm mb-6`}>\n        <div className=\"p-4\">\n          <div className=\"flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4\">\n            {/* Search input */}\n            <div className=\"flex-grow relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <MagnifyingGlassIcon className={`h-5 w-5 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`} />\n              </div>\n              <input\n                type=\"text\"\n                placeholder=\"Search scans...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className={`block w-full pl-10 pr-4 py-2 border ${darkMode ? 'bg-gray-700 border-gray-600 placeholder-gray-400 text-white' : 'border-gray-300 placeholder-gray-500 text-gray-900'} rounded-md`}\n              />\n            </div>\n\n            {/* Sort controls */}\n            <div className=\"flex space-x-2\">\n              <div className={`inline-flex shadow-sm rounded-md ${darkMode ? 'bg-gray-700' : 'bg-gray-100'}`}>\n                <button\n                  className={`px-3 py-2 rounded-l-md text-sm font-medium ${sortField === 'timestamp' ? (darkMode ? 'bg-gray-600 text-indigo-300' : 'bg-indigo-100 text-indigo-700') : ''}`}\n                  onClick={() => handleSort('timestamp')}\n                >\n                  Date\n                  {sortField === 'timestamp' && (\n                    sortDirection === 'asc' \n                      ? <ArrowUpIcon className=\"ml-1 h-4 w-4 inline\" />\n                      : <ArrowDownIcon className=\"ml-1 h-4 w-4 inline\" />\n                  )}\n                </button>\n                <button\n                  className={`px-3 py-2 text-sm font-medium ${sortField === 'name' ? (darkMode ? 'bg-gray-600 text-indigo-300' : 'bg-indigo-100 text-indigo-700') : ''}`}\n                  onClick={() => handleSort('name')}\n                >\n                  Case ID\n                  {sortField === 'name' && (\n                    sortDirection === 'asc' \n                      ? <ArrowUpIcon className=\"ml-1 h-4 w-4 inline\" />\n                      : <ArrowDownIcon className=\"ml-1 h-4 w-4 inline\" />\n                  )}\n                </button>\n                <button\n                  className={`px-3 py-2 rounded-r-md text-sm font-medium ${sortField === 'patient' ? (darkMode ? 'bg-gray-600 text-indigo-300' : 'bg-indigo-100 text-indigo-700') : ''}`}\n                  onClick={() => handleSort('patient')}\n                >\n                  Patient\n                  {sortField === 'patient' && (\n                    sortDirection === 'asc' \n                      ? <ArrowUpIcon className=\"ml-1 h-4 w-4 inline\" />\n                      : <ArrowDownIcon className=\"ml-1 h-4 w-4 inline\" />\n                  )}\n                </button>\n              </div>\n              <button\n                onClick={() => setShowFilters(!showFilters)}\n                className={`inline-flex items-center px-4 py-2 border rounded-md text-sm font-medium ${showFilters \n                  ? (darkMode ? 'bg-indigo-700 text-white border-indigo-500' : 'bg-indigo-100 text-indigo-700 border-indigo-300') \n                  : (darkMode ? 'border-gray-600 text-gray-300 hover:bg-gray-700' : 'border-gray-300 text-gray-700 hover:bg-gray-50')\n                }`}\n              >\n                <FunnelIcon className=\"mr-2 h-4 w-4\" />\n                Filters\n              </button>\n        </div>\n      </div>\n\n          {/* Expanded filters */}\n          {showFilters && (\n            <div className={`mt-4 pt-4 border-t ${darkMode ? 'border-gray-700' : 'border-gray-200'}`}>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Time Period</label>\n                  <select\n                    value={dateFilter}\n                    onChange={(e) => setDateFilter(e.target.value)}\n                    className={`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${\n                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-white'\n                    }`}\n                  >\n                    <option value=\"all\">All time</option>\n                    <option value=\"today\">Last 24 hours</option>\n                    <option value=\"week\">Last 7 days</option>\n                    <option value=\"month\">Last 30 days</option>\n                  </select>\n                </div>\n                <div>\n                  <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Nodules</label>\n                  <select\n                    value={noduleFilter}\n                    onChange={(e) => setNoduleFilter(e.target.value)}\n                    className={`block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md ${\n                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-white'\n                    }`}\n                  >\n                    <option value=\"all\">All scans</option>\n                    <option value=\"with_nodules\">With nodules</option>\n                    <option value=\"without_nodules\">Without nodules</option>\n                  </select>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Results grid */}\n      {filteredResults.length === 0 ? (\n        <div className={`text-center py-12 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>\n          <DocumentTextIcon className=\"mx-auto h-12 w-12 mb-4 opacity-50\" />\n          <h3 className=\"text-lg font-medium mb-1\">No results found</h3>\n          <p className=\"text-sm\">Try adjusting your search or filters</p>\n        </div>\n      ) : (\n        <>\n          <div className=\"grid grid-cols-1 gap-8\">\n            {getCurrentPageItems().map(scan => {\n              const hasNodules = scanHasNodules(scan);\n              const isAnimated = animatedItems.includes(scan.case_name);\n              const patientName = extractPatientName(scan);\n              const clinicalNotes = extractTitle(scan);\n              const creationDate = formatDate(scan.timestamp);\n              \n              return (\n              <Link \n                  to={`/results/${scan.case_name}`} \n                  key={scan.case_name}\n                  className={`block ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-lg overflow-hidden transition-all duration-300 hover:shadow-xl transform hover:-translate-y-1 ${\n                    isAnimated ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-4'\n                  }`}\n                >\n                  <div className=\"flex flex-col md:flex-row\">\n                    {/* Scan Image Preview - Left side */}\n                    <div className=\"relative md:w-1/3 bg-gray-100 overflow-hidden\" style={{ height: '260px' }}>\n                      <InteractiveViewer \n                        caseId={scan.case_name}\n                        selectedNoduleId={null}\n                        resultsPageView={true}\n                      />\n                    </div>\n\n                    {/* Content - Right side */}\n                    <div className={`p-6 md:w-2/3 ${hasNodules ? (darkMode ? 'bg-green-900/20' : 'bg-green-50') : ''}`}>\n                      <div className=\"flex justify-between items-start mb-2\">\n                        <h3 className={`text-xl font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`}>\n                          {patientName}\n                        </h3>\n                        <div className=\"flex items-center space-x-2\">\n                          {hasNodules && (\n                            <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                              darkMode ? 'bg-green-800 text-green-100' : 'bg-green-100 text-green-800'\n                            }`}>\n                              Nodules Detected\n                            </span>\n                          )}\n                          {canDeleteScan(scan) && (\n                            <button\n                              onClick={(e) => openDeleteModal(scan, e)}\n                              className={`p-1 rounded-full ${darkMode ? 'hover:bg-gray-700 text-gray-400 hover:text-gray-200' : 'hover:bg-gray-100 text-gray-500 hover:text-gray-700'}`}\n                            >\n                              <TrashIcon className=\"h-4 w-4\" />\n                            </button>\n                          )}\n                        </div>\n                      </div>\n                      \n                      {/* Date */}\n                      <div className={`text-sm mb-3 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>\n                        {creationDate}\n                      </div>\n                      \n                      {/* Clinical Notes */}\n                      <div className=\"mb-4\">\n                        <h4 className={`text-sm font-medium mb-1 ${darkMode ? 'text-gray-200' : 'text-gray-700'}`}>\n                          Clinical Notes:\n                        </h4>\n                        <p className={`text-sm line-clamp-4 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>\n                          {clinicalNotes || \"No clinical notes available\"}\n                        </p>\n                      </div>\n                      \n                      <div className=\"flex justify-end items-center mt-4\">\n                        <span className={`font-medium ${darkMode ? 'text-indigo-400' : 'text-indigo-600'}`}>\n                          View details \n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </Link>\n              );\n            })}\n          </div>\n\n          {/* Pagination */}\n          {totalPages > 1 && (\n            <div className=\"mt-8 flex justify-center\">\n              <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\" aria-label=\"Pagination\">\n                <button\n                  onClick={() => handlePageChange(currentPage - 1)}\n                  disabled={currentPage === 1}\n                  className={`relative inline-flex items-center px-2 py-2 rounded-l-md border ${\n                    darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-white text-gray-500'\n                  } text-sm font-medium ${\n                    currentPage === 1 \n                      ? 'opacity-50 cursor-not-allowed' \n                      : darkMode \n                        ? 'hover:bg-gray-600' \n                        : 'hover:bg-gray-50'\n                  }`}\n                >\n                  <span className=\"sr-only\">Previous</span>\n                  <ChevronLeftIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\n                </button>\n\n                {[...Array(totalPages)].map((_, index) => (\n                  <button\n                    key={index + 1}\n                    onClick={() => handlePageChange(index + 1)}\n                    className={`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${\n                      currentPage === index + 1\n                        ? darkMode\n                          ? 'z-10 bg-indigo-600 border-indigo-500 text-white'\n                          : 'z-10 bg-indigo-50 border-indigo-500 text-indigo-600'\n                        : darkMode\n                          ? 'border-gray-600 bg-gray-700 text-gray-300 hover:bg-gray-600'\n                          : 'border-gray-300 bg-white text-gray-500 hover:bg-gray-50'\n                    }`}\n                  >\n                    {index + 1}\n                  </button>\n                ))}\n\n                <button\n                  onClick={() => handlePageChange(currentPage + 1)}\n                  disabled={currentPage === totalPages}\n                  className={`relative inline-flex items-center px-2 py-2 rounded-r-md border ${\n                    darkMode ? 'border-gray-600 bg-gray-700 text-gray-300' : 'border-gray-300 bg-white text-gray-500'\n                  } text-sm font-medium ${\n                    currentPage === totalPages \n                      ? 'opacity-50 cursor-not-allowed' \n                      : darkMode \n                        ? 'hover:bg-gray-600' \n                        : 'hover:bg-gray-50'\n                  }`}\n                >\n                  <span className=\"sr-only\">Next</span>\n                  <ChevronRightIcon className=\"h-5 w-5\" aria-hidden=\"true\" />\n                </button>\n              </nav>\n            </div>\n          )}\n        </>\n      )}\n\n      {/* Delete confirmation modal */}\n      {showDeleteModal && (\n        <div className=\"fixed inset-0 z-10 overflow-y-auto\" aria-labelledby=\"modal-title\" role=\"dialog\" aria-modal=\"true\">\n          <div className=\"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n            <div className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" aria-hidden=\"true\" onClick={() => setShowDeleteModal(false)}></div>\n            <span className=\"hidden sm:inline-block sm:align-middle sm:h-screen\" aria-hidden=\"true\">&#8203;</span>\n            <div className={`inline-block align-bottom ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full`}>\n              <div className=\"px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n                <div className=\"sm:flex sm:items-start\">\n                  <div className=\"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10\">\n                    <ExclamationCircleIcon className=\"h-6 w-6 text-red-600\" aria-hidden=\"true\" />\n                  </div>\n                  <div className=\"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left\">\n                    <h3 className={`text-lg leading-6 font-medium ${darkMode ? 'text-white' : 'text-gray-900'}`} id=\"modal-title\">\n                      Delete Scan\n                    </h3>\n                    <div className=\"mt-2\">\n                      <p className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-500'}`}>\n                        Are you sure you want to delete this scan? This action cannot be undone.\n                      </p>\n                      <p className={`mt-2 text-sm font-medium ${darkMode ? 'text-gray-200' : 'text-gray-700'}`}>\n                        {scanToDelete?.case_name}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className={`px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse ${darkMode ? 'bg-gray-700' : 'bg-gray-50'}`}>\n                <button\n                  type=\"button\"\n                  className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm\"\n                  onClick={handleDeleteScan}\n                >\n                  Delete\n                </button>\n                <button\n                  type=\"button\"\n                  className={`mt-3 w-full inline-flex justify-center rounded-md border ${\n                    darkMode ? 'border-gray-500 bg-gray-700 text-white hover:bg-gray-600' : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                  } shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm`}\n                  onClick={() => setShowDeleteModal(false)}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n      </div>\n      )}\n    </div>\n  );\n};\n\nexport default ResultsPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}